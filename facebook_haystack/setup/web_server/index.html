<!DOCTYPE html>

<html>
<head>
<title>JavaScript file upload</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<script type="text/javascript">
var upload = function() {
    var photo = document.getElementById("photo");
    var file = photo.files[0];
    var fr = new FileReader();

    var preview = document.getElementById("preview");
    var photoText = document.getElementById("photoText");

    fr.onload = function(){preview.src = fr.result; photoText.textContent = fr.result};
    fr.readAsDataURL(file);

    console.log("File: " + file.name + ", " + file.size + ", " + file.type);

  
    //setTimeout(function(){ }, 1000);
    

    return false;
};

var send = function () {
    var boundary = this.generateBoundary();
    var xhr = new XMLHttpRequest;

    xhr.open("POST", "/", true);
    xhr.onreadystatechange = function() {
        if (xhr.readyState === 4) {
            alert(xhr.responseText);
        }
    };
    var contentType = "multipart/form-data; boundary=" + boundary;
    xhr.setRequestHeader("Content-Type", contentType);

    for (var header in this.headers) {
        xhr.setRequestHeader(header, headers[header]);
    }

    // here's our data variable that we talked about earlier
    var data = this.buildMessage(this.elements, boundary);

    // finally send the request as binary data
    xhr.sendAsBinary(data);
}
</script>
</head>
<body>

<form>
  <fieldset>
    <legend>Upload photo</legend>
    <input type="file" name="photo" id="photo">
    <!-- <input type="submit" value="Upload"> -->
    <hr>
    <img src="" alt="Image preview" id="preview">
  </fieldset>
</form>
<p id="photoText"></p>
<button onclick="upload();"> Preview </button>

</body>
</html>